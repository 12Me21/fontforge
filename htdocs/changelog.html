<HTML>
<HEAD>
  <!-- Created with AOLpress/2.0 -->
  <!-- AP: Created on: 27-Aug-2002 -->
  <!-- AP: Last modified: 9-Nov-2007 -->
  <TITLE>Change log for FontForge</TITLE>
  <LINK REL="icon" href="ffanvil16.png">
  <LINK REL="stylesheet" TYPE="text/css" HREF="FontForge.css">
</HEAD>
<BODY>
<DIV id="in">
  <H1 ALIGN=Center>
    <A NAME="change-log">Changes</A> <SMALL>(Enhancements &amp; Bug Fixes)</SMALL>
  </H1>
  <P>
  Changes since the last release may be found by performing a "cvs log" command
  on the file stamp.c.
  <BLOCKQUOTE ID="lit">
    <TABLE>
      <TR>
	<TD><B><SMALL>TEGEUS:</SMALL></B><BR>
	  &nbsp; &nbsp; &nbsp; Tell me,<BR>
	  What is your opinion of Progress? Does it, for example,<BR>
	  Exist? Is there ever progression without retrogression?<BR>
	  Therefore is it not true that mankind<BR>
	  Can more justly be said increasingly to Gress?</TD>
	<TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
	  &nbsp;</TD>
	<TD VALIGN="Bottom"><P ALIGN=Right>
	  -- <SMALL>A Phoenix too Frequent<BR>
	  Christopher Fry, 1950</SMALL></TD>
      </TR>
      <TR>
	<TD COLSPAN=3>
	    <HR>
	</TD>
      </TR>
      <TR>
	<TD>"The trouble is," he said, "is that things <I>never</I> get better,<BR>
	  they just stay the same, only more so.</TD>
	<TD>&nbsp; &nbsp; &nbsp; &nbsp;</TD>
	<TD VALIGN="Bottom"><P ALIGN=Right>
	  -- <SMALL><STRIKE>Faust</STRIKE> <FONT COLOR="Red">Eric</FONT><BR>
	  Terry Pratchett, 1990</SMALL></TD>
      </TR>
    </TABLE>
  </BLOCKQUOTE>
  <UL>
    <LI>
      10-Nov-2007
      <UL>
	<LI>
	  Another bug when loading feature files
      </UL>
    <LI>
      9-Nov-2007
      <UL>
	<LI>
	  Introduced Raph Levien's Spiro curves. Please
	  <A href="http://libspiro.sf.net">download <B>libspiro</B></A> before using
	  fontforge.
	<LI>
	  Deal with things that got deprecated as the mac moved from 10.4 to 10.5
	  <UL>
	    <LI>
	      NSAddImage and family have been replaced by dlopen
	    <LI>
	      the old mechanism for referencing a resource fork from POSIX "foo/rsrc" has
	      changed to "foo/..namedfork/rsrc".
	  </UL>
	  <P>
	  The new stuff all worked as far back as 10.3 -- but FontForge source is no
	  longer compatible with 10.2.
	<LI>
	  In a truetype font, if a substitution lead to an unencoded glyph and the
	  cursor hung over the substitution long enough to invoke the popup, then we'd
	  generate a tiny font containing just the unencoded glyph, we'd complain that
	  there were no encoded glyphs, we'd dismiss the popup, we'd generate the glyph
	  image, then we'd try to free it with no free function because the popup was
	  dismissed.
	<LI>
	  Merge Feature File didn't actually merge things in, it forgot about existing
	  things -- which caused problems for kerning classes which get stored in two
	  lists.
	<LI>
	  Allow people to order entries in the PostScript Private dictionary (in Font
	  Info)
	<LI>
	  Give the user control over how much arrow keys accelerate when holding down
	  the Alt (Meta) key.
	<LI>
	  People want a Snap To Int preference item.
	<LI>
	  Simplify sometimes ignored points.
	<LI>
	  People expect to be able to drag guidelines from the rulers (because everyone
	  else does that) and don't want to bother to learn FF's mechanism. So make
	  that possible.
	<LI>
	  Dave C wants to be able to use Cntl-Tab to switch tabs in the charview.
	<LI>
	  If freetype gets a single point open contour in postscript mode, it simply
	  skips the contour (does not call FT_MoveTo on it). This screwed up my attempt
	  to match the results of freetype with the actual splines and caused a crash.
	<LI>
	  Glyphs with no contours didn't set widthset when read from ufo and so were
	  viewed as empty.
	<LI>
	  FF was expecting descent to be a postive value in a ufo (it is in
	  ArialBlack.ufo), but it seems to be negative in most UFOs.
	<LI>
	  Erik wants the creation order of contours preserved when reading a glif file.
	<LI>
	  Oops. glyph/glyphPen types got the wrong names in the fontforge python module.
	  (interchanged)
	<LI>
	  remove the Elide command. (There's no reason to use it, Merge is always better,
	  it just confused people.
	<LI>
	  Refrain from simplifying an order2 point where the second derivative changes
	  sign.
	<LI>
	  If a font has no "fullname" field (and fonts aren't required to have one)
	  ff would crash when generating the font.
	<LI>
	  Ability to Import/Export Raph Levien's plate file format.
	<LI>
	  If I moved a corner point adjacent to a tangent, the slope on the other side
	  of the tangent did not change.
	<LI>
	  Exporting a glyph to BMP or PNG was broken, probably since the addition of
	  python import export filters.
	<LI>
	  Add a Strftime scripting command to the legacy language.
	<LI>
	  Werner points out that I misspelled "persistent" as "persistant" in many
	  places, including python member names. Correct that. (but leave the old,
	  misspelled membernames around but undocumented in case anyone has been mislead
	  by my previous documentation.
	<LI>
	  Add new python stuff to provide access to spiros.<BR>
	  The fontforge module has a new method -- hasSpiro() which returns whether
	  we've got access to libspiro or not.<BR>
	  The module also has a bunch of numeric constants defined spiroG4, spiroG2,
	  etc. for use in the<BR>
	  The Contour type has a new member -- spiros which is a tuple of spiro control
	  points (which are themselves tuples: x,y,type,flags, where type is one of
	  the numeric constants above.
	<LI>
	  People would complain that the python interface would give them "Invalid
	  second order spline" but no one bothered to give me a test case. I hope I've
	  tracked it down now.
	<LI>
	  Add a "problem" to check for glyphs whose bounding boxes are: too tall, too
	  short, too wide, too much to the left.
	<LI>
	  Used to be I had many problems checked by default. Best to turn them all
	  off.
	<LI>
	  Oops. FF was using Py_BuildValue("s") on something that was already a python
	  string.
	<LI>
	  Adam Twardoch suggests that codepoints in the PUA have their script determined
	  by their name (rather than just returning DFLT). Since Adobe used to put
	  things like "a.sc" in this area, that seems a good idea.
	<LI>
	  FF marked almost all fonts with the Oblique bit in the OS/2 table.
	<LI>
	  - Patch from Alexej for his diagonal hinting routines, fixes an ugly problem
	  reported by Max Rabin.
	<LI>
	  Various fixes in stem detection. In particular added a concept of "base start"
	  and "base end" for curved segments of stem edges, allowing to determine more
	  precisely if an active zone (which merges left and right segments together)
	  should actually be considered "curved" at its
	<LI>
	  Make implied points to be ignored when determining a diagonal stem validity.
	<LI>
	  Swith the timestamps to GMT. Prior to this all timestamps have been PS/DT,
	  but now that other people are making source changes GMT seems more sensible.
	<LI>
	  Max Rabkin supplies a patch to let python import plate files.
	<LI>
	  A couple of new name table string ids: WWS Family &amp; WWS Subfamily.<BR>
	  Provide reasonable defaults for the wws* ttf names.
	<LI>
	  Correct the list of dutch font styles.
	<LI>
	  Most of the items in the popup menu of the lookup pane didn't work.
	<LI>
	  FF wasn't loading python init files from ~/.FontForge/python
	<LI>
	  When I fixed mark to ligature positioning I broke the other three types of
	  anchor positioning (to base, to mark &amp; cursive).
	<LI>
	  If you pressed the [*] Default check box in the Font
	  Info-&gt;OS/2-&gt;Panose area, the values didn't go back to the defaults.
	<LI>
	  When copying glyphs from one font to another ff would sometimes use a temporary
	  value of -2 for the orig_pos. This meant that reference fixups didn't work
	  when looking at those glyphs.
	<LI>
	  Drat. Typo when copying a contextual lookup from one font to another caused
	  a crash.
	<LI>
	  Add a new point tool which creates curved points which are always either
	  horizontally or vertically oriented. (I call 'em hvcurves)
	<LI>
	  Use ~/.FontForge instead of ~/.PfaEdit
	<LI>
	  I'm told there was a typo in my Bulgarian text for the Print/Display dlg,
	  and that this should fix it.
	<LI>
	  Get some proper Belorussian text.
	<LI>
	  Several bugs in my mark attachment routines. There was an assumption that
	  only one mark could be attached to a base glyph per sub-table. This is wrong
	  for mark to base, in that there can be several anchor classes per subtable.
	  It is even worse for mark to ligature where there can be many marks per anchor
	  class (one per ligature position).
	<LI>
	  Having done this make sure we don't use the same anchor point more than once.
	<LI>
	  What glyph class should be used by default if a glyph is both a ligature
	  and a mark? Probably mark. There are greek accent ligatures, and its probably
	  more important to treat them as marks than as ligatures (I don't know any
	  fonts which actually "skip ligatures" but there are lots which "skip marks").
	<LI>
	  Select-&gt;Next/Prev Point always selected the first point. Select First
	  point did the wrong thing.
	<LI>
	  Pressing the [Refresh] button could crash ff if a "FontData" depended on
	  another (same font).
	<LI>
	  Someone (John ?Morrison?) requested a way to access fonts by numeric index
	  rather than font name when opening font collections like ttc files or dfonts.
	<LI>
	  * I no longer have separate l/lpotential and r/rpotential pairs &Acirc;&nbsp;
	  of point data objects. Instead I use just 'l' and 'r' accompanied by
	  &Acirc;&nbsp; boolean flags indicating their state as "potential". This greatly
	  &Acirc;&nbsp; simplifies some tests and makes the code more readable. * When
	  I am adding a chunk based on a single point to an existing stem, &Acirc;&nbsp;
	  I always mark the second point as "potential". Later this state can
	  &Acirc;&nbsp; be changed if check based on the second point produces the
	  same chunk, &Acirc;&nbsp; or at least doesn't produce another (conflicting)
	  stem. Again, this &Acirc;&nbsp; simplifies some tests which accompany adding
	  new chunks and makes the &Acirc;&nbsp; result of the stem detection less
	  dependent from the order in which &Acirc;&nbsp; the points are processed.
	  * I allow assigning a point to a stem even when its distance from the
	  &Acirc;&nbsp; stem edge is larger than standard dist_error_hv or dist_error_diag,
	  &Acirc;&nbsp; if only the difference between maximum possible deviations
	  to the &Acirc;&nbsp; both sides of the edge doesn't exceed the double
	  dist_error_* value. &Acirc;&nbsp; This prevents us from adding several
	  almost-coincident hints, actually &Acirc;&nbsp; controlling the same stem.
	  * I have added a function which performs some stem normalization, &Acirc;&nbsp;
	  sorting chunks by point coordinates. For HV stems it also can &Acirc;&nbsp;
	  slightly modify the positioning of the stem edges preferring the &Acirc;&nbsp;
	  coordinate which is closer to most points assigned to each edge. * There
	  is now a special function used to compare conflicting stems &Acirc;&nbsp;
	  and decide if one of these two should be preferred, or they both are
	  &Acirc;&nbsp; worth to be output. * The detection of serifs and similar elements,
	  which, not being &Acirc;&nbsp; exactly horizontal/vertical, still have to
	  be marked with a HV &Acirc;&nbsp; stem, has been improved (two points, forming
	  a serif termination, &Acirc;&nbsp; now should not necessarily follow each
	  other).
	<LI>
	  Drat. If we had libjpeg and not libpng we'd get a complaint about an undefined
	  symbol.
	<LI>
	  Add "Mismatch Unicode &amp; Name" to the Find Problems dlg.
	<LI>
	  There are ttf files in existance where glyph names do not match unicode code
	  points. Tons of fonts use ".notdef" for glyphs other than "GID=0". Other
	  fonts use ASCII glyph names (space, exclam, numbersign,...) for glyphs in
	  other scripts (Kedage-n.ttf does this).
	<LI>
	  In the past, ff has felt that the presence of a zero-width ".null" and
	  "nonmarkingreturn" glyph meant that a font was not mono-space. In the future
	  ignore these glyphs when determining whether a font has fixed width.
	<LI>
	  in some rare cases we got an uninitialized value in spline-&gt;line display
	  conversion.
	<LI>
	  Up the size of the File-&gt;Recent menu to 10, and include non-sfd files
	  in the list.
	<LI>
	  The routine to create an apple state machine from a set of OpenType
	  ('init','medi','fina','isol') forms would often crash.
	<LI>
	  When scaling BlueValues, or other arrays, a trailing space after the last
	  number and before the ']' was considered an error. If found then ff would
	  not scale that entry.
      </UL>
    <LI>
      2-Oct-2007
      <UL>
	<LI>
	  Add <CODE>Edit-&gt;Select-&gt;Autohintable</CODE>
	<LI>
	  Typo in parsing cmap format=6 subtables could cause a crash (or eccentric
	  behavior)
	<LI>
	  Can build fontforge so that it is a python extension (as well as embedding
	  python in ff).
	  <BLOCKQUOTE>
	    <PRE>$ ./configure --enable-pyextension
</PRE>
	  </BLOCKQUOTE>
	<LI>
	  If a tt spline had a control point on top of an on-curve point we would lose
	  track of it when generating the font.
	<LI>
	  Add support for the Uncode variation subtable of the 'cmap' encoding table
	  (format=14).
	<LI>
	  add xdg-open to the list of "known" browsers.
	<LI>
	  Patch from Torsten Bronger. Got the args wrong in (python) font.glyphs.
	<LI>
	  Fabrice Popineau &amp; Taco Hoekwater point out that in the featurefile output
	  routines I was using a single backslash inside a printf string. The intent
	  was to output a single backslash. But I actually need to quote the backslash
	  with another to do that.
	<LI>
	  If a text string were extremely long it could overflow the 16 bits allowed
	  for a width in a metrixedit column. Truncate to 32767 in that case. Still
	  can't scroll over the whole thing, but editing it will pop up a better view
	  which will allow it all to be displayed.
	<LI>
	  If there are no slots in the current encoding, then clicking on the encoding
	  menu caused a crash.
	<LI>
	  Give the user control over the code pages/unicode ranges fields of the OS/2
	  table. Add python scripting commands to access them too.
	<LI>
	  When the user renames a glyph then things dependant on it should change
	  too.<BR>
	  So if any substitution (or pairwise positioning) refers to the old name,
	  change it to refer to the new.<BR>
	  If any contextual change refers to the old name change to the new.<BR>
	  If any class of glyphs (kerning class, apple state machine, contextual by
	  classes) refers to the old name change to the new.
	  <P>
	  More debateable: if we change "f" to "u0066" then change "f.sc" to "u0066.sc"
	  and "f_f_l" to "u0066_u0066_l" (and recurse on those name changes).
	<LI>
	  Guess at the meaning for GDEF glyph class component glyph:
	  <UL>
	    <LI>
	      Something not encoded
	    <LI>
	      Something which is refered to by at least one other glyph (as a reference)
	    <LI>
	      Something which is not generated by GSUB
	  </UL>
	<LI>
	  Further improvements to the auto instructor.
	<LI>
	  Make the [Guess] button in FontInfo-&gt;Private active when BlueScale is
	  selected. (and make it work too).
	<LI>
	  Oops. A font member in python was mis-named. Documented to be "loadState"
	  was "loadStyle". Corrected to match the documentation.
	<LI>
	  Some of the 'maxp' checks in the validator were off by 1, so fontlint would
	  report errors on the glyph with the maximum value.
	<LI>
	  Validator was checking non-composite glyphs against composite boundries.
	<LI>
	  Barry Schwartz points out that I should validate the PostScript Private
	  dictionary (Check that entries have the right types, check that BlueValues:
	  has an even number of elements, is in order, that pairs are separated by
	  bluefuzz*2+1, not too big for bluescale etc.).
	<LI>
	  FF would crash when building accented glyphs from unicode data that included
	  a space as the base glyph.
	<LI>
	  Torsten Bronger points out that "import" is a python keyword and can't (easily)
	  be used as a member/method name. So change the glyph.import function to
	  importOutlines.
	<LI>
	  Patch by Mathias Kilian OpenBSD needs an include file linux doesn't (or rather
	  that linux imports in another include file) declaration statement mixup.
	<LI>
	  Patch by Michal Nowakowski to disambiguate some strings and to make sure
	  some others get translated.
      </UL>
    <LI>
      17-Sept-2007
      <UL>
	<LI>
	  Patch from Daniel Johnson. FF didn't compile --with-regular-link
	<LI>
	  And FF didn't compile if it had libpng but not libjpeg
	<LI>
	  Added some warning messages when doing AutoInstr so that if a font does not
	  contain a private dictionary, or if none of the selected glyphs contain hints,
	  then let the user know s/he isn't going to get very useful instructions.
      </UL>
    <LI>
      15-Sept-2007
      <UL>
	<LI>
	  Added the ability to upload a font to the
	  <A HREF="http://www.openfontlibrary.org/">open font library</A>. (You need
	  to have created an account with them first).
	<LI>
	  Further improvements to the auto instructor.
	<LI>
	  When all glyphs are selected and the user auto-instructs, then FontForge
	  will clear any legacy tables ('fpgm', 'prep' and 'cvt&nbsp;'). The old values
	  will be of no use, and they just get in the way.
	<LI>
	  Add a Edit-&gt;Select-&gt;Select by Script command<BR>
	  Make the Select by Name take a wildcard (so you could select "*.sc").
	<LI>
	  ApplySubstitutions still had problems. Caused crashes in a font with
	  instructions.
	<LI>
	  If one used the metrics view to create a kerning lookup then: there would
	  be no 'kern' feature in the feature list yet, and the display would randomly
	  lose track of kern pairs and then create new ones. Very confusing.
	<LI>
	  Hmm. In some cases Merge Fonts didn't copy over lookup info.<BR>
	  Add the ability to merge cross-font kerning pairs (in case the two fonts
	  being merged have the same glyphs for those which are in both fonts).
	<LI>
	  Provide a mass glyph rename menu item.
	<LI>
	  The [Merge] button in Font Info-&gt;Lookups was disabled when two subtables
	  in the first lookup were selected.
	<LI>
	  If a glyph ended in a suffix (one.superior, etc.), then changes to that glyph
	  were not reflected in the fontview.
	<LI>
	  Add the ability to Populate a lookup from the selection (in the lookup sub-table
	  dialogs)<BR>
	  Do a better job of providing default values for single substitutions &amp;
	  positions.
	<LI>
	  In the Print/Display dlg, deleting something so that the next line was blank
	  caused ff to crash.
	<LI>
	  The Encoding-&gt;Make From Font menu item should be disabled if the encoding
	  is not custom.
	<LI>
	  Fixed a system specific crash in the BDF Info window.
	<LI>
	  Major rewrite of tilepath. Now has initial, medial, final &amp; isolated
	  tiles which it will use depending on the circumstances. No longer uses the
	  clipboard, but you can draw the tiles in the dlg.
	<LI>
	  In Italic/Oblique fonts (those where the font has an italic angle specified)
	  make the center in width command correct for the italic angle.
	<LI>
	  Round to Int didn't round anchor points.
	<LI>
	  The Control Point Info window could wander off the bottom of the screen.
	  I was very carefully calculating its position -- and then not using the result.
	<LI>
	  InkScape stuffs bitmap images into svg files using the data URI<BR>
	  &nbsp; &nbsp;data:&lt;mimetype&gt;,&lt;data&gt;<BR>
	  (see IETF standard RFC 2397)
	  <P>
	  So, I'll support this now as my only way of handling type3 style svg fonts
	  with embedded bitmaps.
	  <P>
	  The standard points out that URIs are limitted to 1024 bytes, but I don't
	  pay any attention to that restriction, and will stuff arbetrary sized images
	  into these things.
	<LI>
	  The code that set up python import/export filters did not put an end of list
	  entry after the last one. Sometimes it would be NULL (correct) and things
	  would work and sometimes it would be garbage and things would crash.
	<LI>
	  Drat. In the outline glyph view, the Import command didn't set the filter
	  properly when you changed the import type.
	<LI>
	  Extend fontforge to keep track of errors encountered when loading 'sfnt'
	  files, and then have fontlint complain about them.
	  <P>
	  Also extend fontlint to do validity checking in glyphs against the 'maxp'
	  table. (This won't matter when editing fonts, as ff will fixup the maxp values
	  when it generates the font, but there might be some existing fonts with buggy
	  'maxp' values).
	<LI>
	  Oops. When changing the weight of a glyph and retaining the counter sizes,
	  fontforge would push two entries onto the undo stack rather than one. (So
	  the user would have to do Edit-&gt;Undo twice to get back to where s/he started
	  from).
	<LI>
	  Added several new python methods to font.
	  <UL>
	    <LI>
	      find(contour) will search the font for all glyphs containing contour and
	      return an interator on that set.
	    <LI>
	      replaceAll(srch,rpl) Will search for the "srch" contour/layer in the font
	      and replace it (each time it occurs) with the "rpl" contour/layer.
	    <LI>
	      glyphs(type) returns an iterator over all glyphs in the font. If present
	      type may be "GID" (default if omitted) or "encoding" and it indicates the
	      order in which the glyphs will be returned.
	  </UL>
	  <P>
	  Added some new members to glyph:
	  <UL>
	    <LI>
	      encoding -- returns the glyph's encoding in the font
	    <LI>
	      script -- returns the OpenType tag (a 4 letter string) of the script of this
	      glyph.
	  </UL>
      </UL>
    <LI>
      31-August-2007
      <UL>
	<LI>
	  New traditional Chinese translation of the UI by Wei-Lun Chao.
	<LI>
	  Updated Vietnamese translation by Clytie Siddall.
	<LI>
	  Removed the old MetaFont command (which didn't work) and replaced it with
	  a styles menu (incorporating the old Effects menu, and a command to change
	  weight, to condense/extend, and to oblique. Added python scripting commands
	  {font,glyph}.{changeWeight,condenseExtend}
	<LI>
	  Lots of new work on the truetype autoinstructor by Alexej and Michal.
	<LI>
	  Add a validation dialog which can be run just before generating a font.
	<LI>
	  Try a different algorithm for approximating splines by line segments (for
	  drawing them in the outline glyph view and elsewhere). This one should show
	  symmetry better.
	<LI>
	  Provide the ability to ask freetype to rasterize glyphs without hints in
	  the Print/Display dlg (even if the glyphs have hints, rasterize them without).
	<LI>
	  Oh dear, rasterizing stroked fonts only worked if multilayer was defined.
	<LI>
	  Try to improve display of stroked fonts.
	<LI>
	  When stroking splines don't let miter joins grow excessively.
	<LI>
	  FF would remove instructions from glyphs that had at least two contours the
	  first of which started with a control point.
	<LI>
	  Add a short cut for Hide Grid in the metrics view.
	<LI>
	  Python 2.5 initializes itself differently from Python 2.[34]. 2.[34] delay
	  the init until an import happens, while 2.5 does it at start up. I just assumed
	  that when I called Py_Initialize that it did so. This led to a crash on 2.[34]
	  when I tried to use my types before the user had tried to import fontforge.
	<LI>
	  Further improvements to tile path.
	<LI>
	  When moving a control point in a ttf font where one side of the cp was a
	  real point, I would allow an implicit point on the far side of the real point
	  to become real.
	<LI>
	  When dragging truetype points around, adjacent implicit points would remain
	  where they were (and not be implicit any longer).
	<LI>
	  FF would randomly crash after removing a lot of glyphs.
	<LI>
	  The knife tool would not cut a contour if it landed on a point.
	<LI>
	  Trying to add a stylename to the size pane of fontinfo generally caused a
	  crash.
	<LI>
	  All blank lines in the display dlg had the same line spacing as that of the
	  first character displayed in the dlg.
	<LI>
	  I don't think feature files where handling classes defined with '-' properly.
	<LI>
	  Read the "lib" structures from UFO/GLIF files into our python persistent
	  data. (And write our persistent data out if it's a dict).
	<LI>
	  Add the ability to call hooks (python functions) when various fontforge events
	  take place.
	<LI>
	  Make fontforge's basic types (Point, Contour, and Layer) be picklable so
	  they can now be saved in an sfd file.
	<LI>
	  Oops. With the inclusion of the library check argument, ff would not compile
	  if NODYNAMIC were set.
	<LI>
	  FontForge now stores the "userdata" python members into the sfd file as pickled
	  objects. (FontForge's own types are not currently pickleable).
	<LI>
	  Add the ability to mark a glyph so that just before being saved its references
	  will be unlinked and we will run remove overlap on it. This means the user
	  can work with the references (and get the automatic updating they confer)
	  and still not have a self-intersecting glyph in the output (think Aring,
	  Ccedilla, Eogonek).
	<LI>
	  Create a fontlint script file.
	<LI>
	  When dumping both apple and opentype bitmap tables if there were a BDF table,
	  then we'd get garbage for 'bloc'/'bhed'.
	<LI>
	  Add some user interface commands to python, and more importantly, add the
	  ability to create menu items which will invoke python scripts, and the ability
	  to add import/export conversion filters (again, python scripts).
	<LI>
	  Counter hints for LCG glyphs came out wrong if autohint had not been applied
	  first.
	<LI>
	  Counter masks were not read out of sfd files properly.
	<LI>
	  Selecting a counter mask in Glyph Info caused FF to crash.
	<LI>
	  The Execute Script dlg would sometimes complain about invalid scrollbar size
	  when it got closed.
	<LI>
	  AddAnchorPoint (scripting command) should be prepared to cast real args to
	  integers.
	<LI>
	  Just as I needed a special "in use" pass of GSUB when reading from a TTC,
	  so I also need an "in use" pass of the MATH table.
	<LI>
	  All this time and I've mapped "nonmarkingreturn" (GID=2) to Unicode+000C
	  instead of Unicode+000D. I'm a twit.
      </UL>
    <LI>
      08-August-2007
      <UL>
	<LI>
	  Support for MicroSoft's new 'MATH' opentype table.
	  <A href="math.html">Element-&gt;Math Info</A>.
	<LI>
	  Michal Nowakowski and Alexej Kryukov have improved truetype hinting.
	<LI>
	  kerning display is off in a pairwise lookup window if a y position adjustment
	  were requested.
	<LI>
	  When reverting a compacted font ff thought the font was compacted even when
	  it was not.
	<LI>
	  Make some effort to retain context in the fontview when changing encodings.
	<LI>
	  ff scripting command CopyReference() was broken.
	<LI>
	  Werner wants little popup windows in show att. Give him some for substitutions.
	<LI>
	  If you examined a kerning pair subtable (either with glyph info or from double
	  clicking on the subtable in the lookup pane) and then pressed [OK], and then
	  generated an afm (tfm, old-style kern table, etc.) you would lose all the
	  kern pairs you examined.
	<LI>
	  Patch by Barry SCHWARTZ to feature file output on 64bit machines.
	<LI>
	  In freetype 2.3.5 the binary layout of the execution context changed.<BR>
	  This means that if ff is compiled against a 2.3.4 library it can't debug
	  truetype if linked with a 2.3.5 library (and vice versa).<BR>
	  So put in checks to see that the library version matches what we expect.
	  <P>
	  Also the contents of one of the structures has changed a bit, and a value
	  that used to live in one field has moved to another (the ppem value moved
	  from (exc)-&gt;size-&gt;metrics.x_ppem to
	  (exc)-&gt;size-&gt;root.metrics.x_ppem.
	  <P>
	  Well, David warned me that this might happen.
	  <P>
	  Warn the user (rather than just silently failing) when we have a freetype
	  version mismatch.
	<LI>
	  Patch from Barry SCHWARTZ. python fontforge.font.addPosSub was expecting
	  its args inside a redundant tuple.
	<LI>
	  New Vietnamese translation from Clytie.<BR>
	  Also some spelling corrections in the original messages.
	<LI>
	  Patch by Barry SCHWARTZ to lookup/subtable comparison.
	<LI>
	  If a metricsview was open, then creating a new glyph slot would potentially
	  screw up memory and sometimes crashed.
	<LI>
	  Edit-&gt;Merge (and simplify) still have bugs.
	<LI>
	  Fix two memory leaks in the metrics view (one was huge).
	<LI>
	  If freetype failed to rasterize a glyph, then we would fall back on returning
	  a bitmap image from our own rasterizer -- even if we asked freetype for a
	  greymap. this caused problems when routines expected byte data rather than
	  bit data.
	<LI>
	  If we were given a cff (otf) font, with a bluevalues array which ended in
	  0 (as [-20 0]) then we would omit the final zero ([-20]).
	<LI>
	  Outputting extension subtables appears to have been broken.
	<LI>
	  The code which was supposed to detect two glyphs with the same set of kerning
	  pairs and use the same data for them didn't work (forcing us to get an extension
	  table which also didn't work).
	<LI>
	  Add some more checks against non-BMP characters when drawing text.
	<LI>
	  For first characters in the kern pair dlg, when editing class 0, the [Edit]
	  button was enabled but did nothing. Should work now.
	<LI>
	  ff could crash if it tried to create a popup image of the &lt;New&gt; line
	  in the substitution pane of Glyph Info.
	<LI>
	  Horizontal Scrolling in the matrix edit widget sometimes forgot to move the
	  column labels.
	<LI>
	  Add glyph name completion to lookup subtable dlg and glyph info panes.
	<LI>
	  addKerningClass didn't parse its arguments correctly.
	<LI>
	  Drat. When printing full page glyphs to a pdf file, the glyph was shifted
	  up by almost the full page and we got a second (and incorrect) title.
	<LI>
	  MS proposes two new feature tags with it's new 'MATH' table.
      </UL>
    <LI>
      23-July-2007
      <UL>
	<LI>
	  I have merged (and substantially rewritten) the Print and Display Dialogs.
	  There is now only one menu item (Print) which (vaguely) the old Display dlg
	  except that it can now be printed. The text area widget now supports OpenType
	  features just as the metrics view does. It also supports ligature carets.
	  <P>
	  The dialog is no longer modal, however it does not get updated with each
	  change to the font (that would make moving a point around in the outline
	  view far too sluggish), instead there is a [Refresh] button the user can
	  press to force an update.
	<LI>
	  It occurred to me that fontforge's current mechanism for setting ligature
	  carets requires that there be a ligature substitution is the exact number
	  of components used to make the glyph. But in indic fonts ligatures are often
	  made up out of other ligatures (I think) which means that there won't be
	  enough caret positions.
	  <P>
	  So I've added a Ligature Caret count to the Element-&gt;Glyph Info dialog
	  to give the user control over it when necessary.
	<LI>
	  Add minimal support for applying apple state machine lookups in metrics view.
	  Support is minimal because:
	  <UL>
	    <LI>
	      Apple seems to figure line breaks before doing substitution process but I
	      do it afterward so I don't know where the line breaks are and I can't enter
	      either the line start or line end state.
	    <LI>
	      When I delete a glyph I delete it. Apple inserts a deleted glyph mark and
	      then removes that later. State machines can respond to deleted glyphs, but
	      I can't.
	    <LI>
	      I don't try to figure out which feature,settings should be on by default.
	      So the user must pick them out manually.
	  </UL>
	<LI>
	  Add popup graphics to the Glyph Info and Lookup subtable dialogs to show
	  substitutions (that is if there is an entry like 'smcp' a =&gt; a.sc then
	  create a popup window showing the "a" glyph and the "a.sc" so the user can
	  see what happens.
	<LI>
	  Another futile attempt at an embolden command. Element-&gt;Embolden
	<LI>
	  Add shortcuts to the anchor control dlg (Page Up/Page Down) to move to the
	  next/previous glyph.
	<LI>
	  Michal Nowakowski has improved the truetype autoinstructor. He warns that
	  it probably still has bugs (as what does not?) so I am leaving the old code
	  available for now. He says it works best in "a clean (uninstructed) font
	  with well defined blue zones and stems".
	<LI>
	  If we have a glyph with multiple encodings, and the secondary encodings occur
	  after the primary ones, then the backmap will probably contain a secondary
	  encoding, which means that when we go to load the font in we will probably
	  notice the secondary encoding twice and forget the primary.
	<LI>
	  I used not to distinguish between ligature anchors and normal mark to base
	  anchors. Unfortunately when I moved to lookups (from features) I had to introduce
	  that distinction. But I didn't work through all the implications and have
	  fixed a number of bugs related to that.
	<LI>
	  Barry SCHWARTZ complains that font info says "fontnames must" but that the
	  cited adobe tech note only says "should". So change "must" to "should".
	<LI>
	  When processing class-based contextual lookups fontforge could not handle
	  class 0 (the class containing "all glyphs not in another class") add code
	  to do that.
	<LI>
	  If the user did not select a Gasp Version (note: active selection was needed,
	  just seeing that it was correct and leaving it didn't work) then [OK] would
	  leave the font with an invalid version and on some systems caused a crash.
	<LI>
	  View-&gt;Insert Glyph After didn't work well on a ligature glyph. It would
	  insert the glyph after the first component of the ligature, not after the
	  last -- which would make more sense.
	<LI>
	  Misnamed some private dict entries when loading from otf.
	<LI>
	  Make entry of ghost hints better.
	<LI>
	  Add the ability to determine whether a point is selected or not from python.
	<LI>
	  Add a mechanism so the user can ask fontforge to check for the existance
	  of optional libraries.
	<LI>
	  Add range checks to some library routines which blindly referenced some BMP
	  arrays with codepoints outside bmp. Broken by UCS2-&gt;UCS4 change.
	<LI>
	  Werner wants GotoChar to be able to switch sub-fonts in a cid keyed font.
	  This may introduce bugs...
	<LI>
	  Revert glyph still wasn't working.
	<LI>
	  Someone complained that using a negative stroke took a very long time but
	  produced correct results. Um. Ok. It's easy always to use the absolute value.
	<LI>
	  Oops. The mac uses UCS2 for filenames, so when I moved to UCS4 I should have
	  changed the mac resource file interface.
	<LI>
	  When creating a mac resource file we only set the type/creator fields and
	  failed to initialize the finderFlags.
	<LI>
	  Fixed crash bug in generating a cursive connection anchor sub-table.
	<LI>
	  In TrueType composite glyphs with the USE_MY_METRICS bit set the lock icon
	  wasn't scrolled properly.
	<LI>
	  The change from UCS2 to UCS4 broke text copy/paste.<BR>
	  We failed to add a terminating NUL of the right size in all cases<BR>
	  We continued to use charset=UCS-2 when it should have been UCS-4
	<LI>
	  FF crashed when trying to View-&gt;Show ATT on a font that appears to me
	  to contain an invalid 'kern' sub-table. I have removed the proximate cause
	  of the crash. I have provided a warning that the kern table appears invalid.
	  And I have cleaned up my internals after detecting the bad sub-table (I had
	  a lookup with a feature but no script and this caused problems).
	<LI>
	  Multiple substitutions in the metrics view did not properly update the count
	  of glyphs to be displayed.
	<LI>
	  If nothing changed in the metrics input field and the output contained a
	  ligature (or a mult subs I suspect). FF would complain.
	<LI>
	  in python, font.generate() didn't work. The PyArg_ParseTupleAndKeywords behaves
	  in a way I did not expect.
	<LI>
	  [Bottom] and [Down] still didn't work for lookup subtables.
	<LI>
	  Try to force the text field in the metricsview to a fixed size. In some fonts
	  it seems to be initialized to a huge value.
	<LI>
	  Add ability to display italic side bearings in the char view.
	<LI>
	  The lines drawn for italic fonts to show the italic origin and width were
	  at slightly the wrong angle (I used a sine when I should have used a tangent).
	<LI>
	  If a font did not have any horizontal metrics then ff would not set the em-size.
	<LI>
	  Show Att trampled on memory when displaying apple contextual substitution
	  state machines.
	<LI>
	  Wasn't parsing apple's 'lcar' table properly.
	<LI>
	  if a font contained a 'post' table but didn't name all names (or something
	  like that), then the attempt to name the glyph based on the encoding was
	  broken after the encoding change.
	<LI>
	  FF did not recognize that a bdf file was greymaped. Broken by the bdf properties
	  work a year ago or so.
	<LI>
	  The import lookups button in fontinfo forgot about the subtables (sort of).
	<LI>
	  The metricsview used the wrong count field to determine whether things changed.
	  It used the glyph count, not the char count (which meant that when we had
	  a ligature and the number of chars was greater than the number of glyphs,
	  things got confused.)
	<LI>
	  In the metrics view, anchored attachments only worked if the base glyph were
	  itself unmoved (that is the mark was placed relative to the unmoved location,
	  not the actual location).
	<LI>
	  The search dialog should provide user with control over the error bound.<BR>
	  The rotate checkbox didn't work if the flip checkbox wasn't checked.
	<LI>
	  If a replace contour added a control point to a point that did not have one
	  (went from a line to a curve) then that control point would get lost.<BR>
	  If a search matched across the start point of a contour then search/replace
	  could go into an infinite loop if the search and replace paths were the same.
	<LI>
	  Find/Replace (replace) didn't work on quadratic splines.
	<LI>
	  Add two python methods:
	  <UL>
	    <LI>
	      Layer.interpolateNewLayer(other-layer,amount)
	    <LI>
	      Font.createInterpolatedGlyph(glyph1,glyph2,amount)
	  </UL>
	  <P>
	  The first creates a new layer by interpolating between the current layer
	  and the layer in the first argument.<BR>
	  The second creates a new glyph in the font by interpolating between the first
	  two arguments. The glyph's unicodecode point and name will be copied from
	  the first argument (the font must not already contain this glyph).<BR>
	  If amount is 0 the result will look like the first glyph, if 1 then like
	  the second.
	<LI>
	  When recovering from a crash, FF would sometimes complain about a mismatched
	  version number. Don't.
	<LI>
	  Problems parsing 'mort' tables could cause a crash.
	<LI>
	  When building a contextual lookup, don't list that lookup as something that
	  it could invoke (ie. list all lookups in this table (GPOS/GSUB) except for
	  ourselves). Don't want to encourage users to create infinite lookup loops.
	<LI>
	  Point matching didn't work when there were references to references and multiple
	  references within a glyph.
	<LI>
	  FF was having problems with extension lookups with multiple sub tables.
	<LI>
	  We were trying to print a trailing NUL in some strings from the fontview.
	<LI>
	  Kerning by classes got broken in metricsview by the addition of support for
	  device tables.
	<LI>
	  A GPOS contextual lookup only listed GSUB lookups in the lookup/sequence
	  dlg<BR>
	  Pressing [OK] in the lookup/sequence dlg caused a crash if no lookup selected.
	<LI>
	  Openfontdlg was looking at the filter listbutton rather than the rename namelist
	  listbutton.
	<LI>
	  mf2pt1 now uses "glyph_dimensions" rather than "bbox"
	<LI>
	  The metrics view should now handle device tables.
	<LI>
	  Goto could crash when used on small encodings.
	<LI>
	  -lang wasn't permitted before -c.
	<LI>
	  Use numeric text fields for anchor positioning.
	<LI>
	  Graham Asher points out that the meanings of underline position in the 'post'
	  table and the FontInfo dictionary are different. One refers to the top of
	  the underline rectangle and one to the center of it.
	<LI>
	  Align point would crash if the selected point were the end point of a contour
	  (or if the two points around it were in the same place).
	<LI>
	  The baseline was not properly located when displaying it in the fontview.
	<LI>
	  The scripting command BitmapsAvail would generally cause FF to crash if done
	  when there was a UI..
	<LI>
	  We seem to be misimplementing my obsolete (sfd file) convention for having
	  duplicate encodings point to the same glyph. Result was that occasionally
	  a glyph would be removed and a pointer to something it refered to would be
	  put in its place.
	<LI>
	  Change the name of activeFontInUI to activeFont<BR>
	  Add an activeGlyph method.<BR>
	  Add the ability to call a python script from a outline view.
	<LI>
	  Hmmm. If a textfield is shifted right, and then resized so there's now room
	  for all the text, the unshift it.
	<LI>
	  Werner suggests that it would be useful to be able to specify wildcards in
	  the goto dlg.
	<LI>
	  Michael Zedler tells me that glyphs output by mf2pt1 contain a line:
	  <PRE> % MF2PT1: bbox 0 90 834 422
</PRE>
	  <P>
	  where the third (so called) bounding box entry is actually the glyph's advance
	  width. I was reluctant to use this at first, because that clearly isn't something
	  that belongs in a bounding box...
	<LI>
	  Werner tells me that lilypond uses a slightly different syntax for the MF2PT1
	  bbox comment, so make our parsing slightly more generous.
	<LI>
	  When creating a new lookup subtable for an anchored lookup, it did not get
	  marked as having anchor classes and feature file output failed because of
	  that.
	<LI>
	  When outputing single lookups, the feature, script and language tags all
	  had ^A where they should have had the second letter of the tag.
	<LI>
	  Remove the code to produce the old, broken, 'size' feature.
      </UL>
      <P>
      <A HREF="oldchangelog.html">Earlier Changes </A><BR>
      <A HREF="pfaeditchangelog.html">Changes to PfaEdit (predecessor to
      FontForge)</A>
  </UL>
</DIV>
</BODY></HTML>
