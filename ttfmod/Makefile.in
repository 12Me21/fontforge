srcdir = @srcdir@

CC = @CC@

X_CFLAGS = @X_CFLAGS@
X_LIBS = @X_LIBS@
X_EXTRA_LIBS = @X_EXTRA_LIBS@
X_PRE_LIBS = @X_PRE_LIBS@

TABLEOBJS = maxp.o OS2.o instrs.o binary.o shorts.o metrics.o _hea.o head.o \
	post.o gasp.o VORG.o
GLYPHOBJS = fontview.o conicutil.o charview.o freetype.o bcdebug.o instrmod.o
ttfmod_OBJECTS = ttfmod-ui.o start.o splashimage.o uiutil.o ttfview.o ttffile.o \
	openfontdlg.o prefs.o cursors.o windowmenu.o psunicodenames.o \
	ttfsave.o $(TABLEOBJS) $(GLYPHOBJS)

WFLAGS = -Wmissing-prototypes -Wunused -Wimplicit -Wreturn-type -Wparentheses
CFLAGS = @CFLAGS@ -I../inc $(WFLAGS) $(X_CFLAGS) @DEFS@

LDFLAGS = @LDFLAGS@
LIBS = -L../libs $(X_LIBS) ../libs/libgdraw.a ../libs/libgunicode.a \
    $(X_PRE_LIBS) -lX11 $(X_EXTRA_LIBS) @LIBS@ -lm

ttfmod: $(ttfmod_OBJECTS)
	$(CC) -o ttfmod $(ttfmod_OBJECTS) stamp.c $(LIBS)

#this makes all the .ui files but wildcarding doesn't work too well if the
# files don't exist.
nomen.h ttfmod-ui.c ttfmod-en.ui: $(srcdir)/nomen-*.c makenomenh.c
	$(CC) -o makenomenh $(CFLAGS) $(srcdir)/makenomenh.c $(LIBS)
	-ln -s $(srcdir)/nomen-*.c .
	./makenomenh ttfmod TtfMod
	mv ttfmod-ui-en.c ttfmod-ui.c

clean:
	-rm -f *.o ttfmod makenomenh *.ui nomen.h _nomen*.c

distclean cleaner:
	-rm -f *.o ttfmod Makefile makenomenh *.ui nomen.h _nomen*.c
