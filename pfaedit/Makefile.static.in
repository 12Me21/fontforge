sharedir = @prefix@/share/pfaedit

CC = @CC@

X_CFLAGS = @X_CFLAGS@
X_LIBS = @X_LIBS@
X_EXTRA_LIBS = @X_EXTRA_LIBS@
X_PRE_LIBS = @X_PRE_LIBS@

pfaedit_OBJECTS =  autohint.o autosave.o autowidth.o bitmapdlg.o \
 bitmapview.o bvedit.o charview.o charviewicons.o cursors.o \
 cvaddpoints.o cvexport.o cvgetinfo.o cvhints.o cvimages.o cvknife.o \
 cvpalettes.o cvpointer.o cvruler.o cvshapes.o cvstroke.o cvtranstools.o \
 cvundoes.o dumpbdf.o dumppfa.o fontinfo.o fontview.o fvcomposit.o \
 fvfonts.o fvimportbdf.o fvmetrics.o images.o metricsview.o \
 parsepfa.o parsettf.o prefs.o psread.o psunicodenames.o savefontdlg.o \
 sfd.o splashimage.o splinefill.o splineoverlap.o splinesave.o \
 splinesaveafm.o splinestroke.o splineutil.o splineutil2.o stamp.o \
 start.o tottf.o transform.o uiutil.o utils.o windowmenu.o  \
 zapfnomen.o othersubrs.o autotrace.o openfontdlg.o encoding.o print.o \
 problems.o pfaedit-ui.o metafont.o alignment.o parsettfbmf.o \
 macbinary.o crctab.o

WFLAGS = -Wmissing-prototypes -Wunused -Wimplicit -Wreturn-type -Wparentheses
CFLAGS = @CFLAGS@ -I../inc $(WFLAGS) $(X_CFLAGS) @DEFS@ '-DSHAREDIR="$(sharedir)"'

LDFLAGS = @LDFLAGS@
LIBS = -L../libs $(X_LIBS) ../libs/libgdraw.a ../libs/libgunicode.a \
    $(X_PRE_LIBS) -lX11 $(X_EXTRA_LIBS) @LIBS@ -L/usr/lib -lm

all: pfaedit.en.ui pfaedit

pfaedit: nomen.h $(pfaedit_OBJECTS)
	$(CC) -o pfaedit $(pfaedit_OBJECTS) $(LIBS)

#this makes all the .ui files but wildcarding doesn't work too well if the
# files don't exist.
nomen.h pfaedit-ui.c pfaedit.en.ui: nomen.*.c makenomenh.c
	gcc -o makenomenh $(CFLAGS) makenomenh.c $(LIBS)
	./makenomenh
	mv pfaedit-ui.en.c pfaedit-ui.c

clean:
	-rm -f *.o pfaedit *.ui nomen.h pfaedit-ui.c makenomenh _nomen.*.c

distclean cleaner: clean
	-rm Makefile
